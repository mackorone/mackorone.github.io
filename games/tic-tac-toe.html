<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Tic-Tac-Toe</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            background-attachment: fixed;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            padding: 20px;
        }

        .back-button {
            position: fixed;
            top: 20px;
            left: 20px;
            padding: 10px 20px;
            font-size: 16px;
            font-weight: 600;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 25px;
            cursor: pointer;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        .back-button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }

        .game-container {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            padding: 30px;
            border-radius: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.2);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            max-width: 90vw;
        }

        h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            text-align: center;
        }

        .game-options {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }

        select {
            padding: 8px 12px;
            border-radius: 15px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1rem;
            outline: none;
            cursor: pointer;
        }

        select option {
            background: #764ba2;
            color: white;
        }

        .status {
            font-size: 1.5rem;
            margin-bottom: 20px;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
            height: 2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .player-turn {
            padding: 5px 15px;
            border-radius: 15px;
            background: rgba(255,255,255,0.2);
            transition: all 0.3s ease;
        }

        .board {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .cell {
            width: 80px;
            height: 80px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease;
            user-select: none;
        }

        .cell:hover:not(.taken) {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }

        .cell.x {
            color: #FFD700;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }

        .cell.o {
            color: #00FFFF;
            text-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
        }

        .cell.win {
            background: rgba(255, 255, 255, 0.4);
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .controls {
            display: flex;
            gap: 15px;
        }

        .btn {
            padding: 12px 24px;
            font-size: 1.2rem;
            font-family: inherit;
            font-weight: 600;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.2s ease;
            background: white;
            color: #667eea;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.4);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        @media (max-width: 480px) {
            .cell {
                width: 70px;
                height: 70px;
                font-size: 2.5rem;
            }
            
            h1 {
                font-size: 2.5rem;
            }
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-button">‚Üê Back</a>

    <div class="game-container">
        <h1>Tic-Tac-Toe</h1>
        
        <div class="game-options">
            <select id="gameMode" onchange="resetGame()">
                <option value="pvp">Player vs Player</option>
                <option value="pvc">Player vs Computer</option>
            </select>
            <select id="difficulty" onchange="resetGame()" style="display: none;">
                <option value="easy">Easy</option>
                <option value="hard">Hard</option>
            </select>
        </div>

        <div class="status" id="status">
            <div id="turn-message">
                Player <span class="player-turn" id="turn-indicator">X</span>'s Turn
            </div>
            <div id="result-message" style="display: none;"></div>
        </div>

        <div class="board" id="board">
            <div class="cell" data-index="0"></div>
            <div class="cell" data-index="1"></div>
            <div class="cell" data-index="2"></div>
            <div class="cell" data-index="3"></div>
            <div class="cell" data-index="4"></div>
            <div class="cell" data-index="5"></div>
            <div class="cell" data-index="6"></div>
            <div class="cell" data-index="7"></div>
            <div class="cell" data-index="8"></div>
        </div>

        <div class="controls">
            <button class="btn" onclick="resetGame()">Restart Game</button>
        </div>
    </div>

    <script>
        const board = document.getElementById('board');
        const cells = document.querySelectorAll('.cell');
        const statusDisplay = document.getElementById('status');
        const turnIndicator = document.getElementById('turn-indicator');
        const gameModeSelect = document.getElementById('gameMode');
        const difficultySelect = document.getElementById('difficulty');
        const turnMessage = document.getElementById('turn-message');
        const resultMessage = document.getElementById('result-message');
        
        let currentPlayer = 'X';
        let gameState = ["", "", "", "", "", "", "", "", ""];
        let gameActive = true;
        let isComputerTurn = false;

        const winningConditions = [
            [0, 1, 2],
            [3, 4, 5],
            [6, 7, 8],
            [0, 3, 6],
            [1, 4, 7],
            [2, 5, 8],
            [0, 4, 8],
            [2, 4, 6]
        ];

        // Audio Context setup (simple beeps)
        let audioContext = null;

        function initAudio() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
        }

        function playSound(type) {
            if (!audioContext) initAudio();
            if (audioContext.state === 'suspended') audioContext.resume();

            const osc = audioContext.createOscillator();
            const gain = audioContext.createGain();
            osc.connect(gain);
            gain.connect(audioContext.destination);

            if (type === 'move') {
                osc.frequency.setValueAtTime(400, audioContext.currentTime);
                osc.frequency.exponentialRampToValueAtTime(600, audioContext.currentTime + 0.1);
                gain.gain.setValueAtTime(0.1, audioContext.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
                osc.start();
                osc.stop(audioContext.currentTime + 0.1);
            } else if (type === 'win') {
                osc.type = 'triangle';
                osc.frequency.setValueAtTime(400, audioContext.currentTime);
                osc.frequency.setValueAtTime(600, audioContext.currentTime + 0.2);
                osc.frequency.setValueAtTime(800, audioContext.currentTime + 0.4);
                gain.gain.setValueAtTime(0.2, audioContext.currentTime);
                gain.gain.linearRampToValueAtTime(0, audioContext.currentTime + 0.6);
                osc.start();
                osc.stop(audioContext.currentTime + 0.6);
            }
        }

        function handleCellClick(clickedCellEvent) {
            const clickedCell = clickedCellEvent.target;
            const clickedCellIndex = parseInt(clickedCell.getAttribute('data-index'));

            if (gameState[clickedCellIndex] !== "" || !gameActive || isComputerTurn) {
                return;
            }

            handleCellPlayed(clickedCell, clickedCellIndex);
            handleResultValidation();
        }

        function handleCellPlayed(clickedCell, clickedCellIndex) {
            gameState[clickedCellIndex] = currentPlayer;
            clickedCell.textContent = currentPlayer;
            clickedCell.classList.add(currentPlayer.toLowerCase());
            clickedCell.classList.add('taken');
            playSound('move');
        }

        function handleResultValidation() {
            let roundWon = false;
            let winningLine = [];

            for (let i = 0; i <= 7; i++) {
                const winCondition = winningConditions[i];
                let a = gameState[winCondition[0]];
                let b = gameState[winCondition[1]];
                let c = gameState[winCondition[2]];

                if (a === '' || b === '' || c === '') {
                    continue;
                }
                if (a === b && b === c) {
                    roundWon = true;
                    winningLine = winCondition;
                    break;
                }
            }

            if (roundWon) {
                resultMessage.innerHTML = `Player <span style="color: ${currentPlayer === 'X' ? '#FFD700' : '#00FFFF'}">${currentPlayer}</span> Wins! üéâ`;
                resultMessage.style.display = 'block';
                turnMessage.style.display = 'none';
                gameActive = false;
                highlightWinningCells(winningLine);
                playSound('win');
                return;
            }

            let roundDraw = !gameState.includes("");
            if (roundDraw) {
                resultMessage.innerText = 'Draw! ü§ù';
                resultMessage.style.display = 'block';
                turnMessage.style.display = 'none';
                gameActive = false;
                return;
            }

            handlePlayerChange();
        }

        function highlightWinningCells(indices) {
            indices.forEach(index => {
                cells[index].classList.add('win');
            });
        }

        function handlePlayerChange() {
            currentPlayer = currentPlayer === "X" ? "O" : "X";
            turnIndicator.textContent = currentPlayer;
            turnIndicator.style.color = currentPlayer === 'X' ? '#FFD700' : '#00FFFF';

            if (gameModeSelect.value === 'pvc' && currentPlayer === 'O' && gameActive) {
                isComputerTurn = true;
                setTimeout(makeComputerMove, 500); // Delay for realism
            } else {
                isComputerTurn = false;
            }
        }

        function makeComputerMove() {
            if (!gameActive) return;

            let index;
            const difficulty = difficultySelect.value;

            if (difficulty === 'easy') {
                index = getRandomMove();
            } else {
                // Hard = Minimax
                index = getBestMove(true);
            }

            const cell = cells[index];
            handleCellPlayed(cell, index);
            handleResultValidation();
        }

        function getRandomMove() {
            const available = [];
            gameState.forEach((cell, index) => {
                if (cell === "") available.push(index);
            });
            return available[Math.floor(Math.random() * available.length)];
        }

        function getBestMove() {
            // Minimax (Perfect AI)
            return minimax(gameState, 'O').index;
        }

        function minimax(newBoard, player) {
            const availSpots = [];
            newBoard.forEach((cell, idx) => {
                if (cell === "") availSpots.push(idx);
            });

            if (checkWinState(newBoard, 'X')) return { score: -10 };
            if (checkWinState(newBoard, 'O')) return { score: 10 };
            if (availSpots.length === 0) return { score: 0 };

            const moves = [];

            for (let i = 0; i < availSpots.length; i++) {
                const move = {};
                move.index = availSpots[i];
                newBoard[availSpots[i]] = player;

                if (player === 'O') {
                    const result = minimax(newBoard, 'X');
                    move.score = result.score;
                } else {
                    const result = minimax(newBoard, 'O');
                    move.score = result.score;
                }

                newBoard[availSpots[i]] = "";
                moves.push(move);
            }

            let bestMove;
            if (player === 'O') {
                let bestScore = -10000;
                for (let i = 0; i < moves.length; i++) {
                    if (moves[i].score > bestScore) {
                        bestScore = moves[i].score;
                        bestMove = i;
                    }
                }
            } else {
                let bestScore = 10000;
                for (let i = 0; i < moves.length; i++) {
                    if (moves[i].score < bestScore) {
                        bestScore = moves[i].score;
                        bestMove = i;
                    }
                }
            }

            return moves[bestMove];
        }

        function checkWinState(board, player) {
            for (let i = 0; i < winningConditions.length; i++) {
                const [a, b, c] = winningConditions[i];
                if (board[a] === player && board[b] === player && board[c] === player) {
                    return true;
                }
            }
            return false;
        }

        function resetGame() {
            gameActive = true;
            currentPlayer = "X";
            isComputerTurn = false;
            gameState = ["", "", "", "", "", "", "", "", ""];
            
            resultMessage.style.display = 'none';
            turnMessage.style.display = 'block';
            
            turnIndicator.textContent = 'X';
            turnIndicator.style.color = '#FFD700';

            cells.forEach(cell => {
                cell.innerHTML = "";
                cell.classList.remove('x', 'o', 'taken', 'win');
            });

            // Update UI visibility based on mode
            if (gameModeSelect.value === 'pvc') {
                difficultySelect.style.display = 'block';
            } else {
                difficultySelect.style.display = 'none';
            }
        }

        cells.forEach(cell => cell.addEventListener('click', handleCellClick));
        
        // Initialize turn indicator color
        turnIndicator.style.color = '#FFD700';
    </script>
</body>
</html>
